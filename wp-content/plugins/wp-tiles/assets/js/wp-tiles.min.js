var Tiles={};!function(t){var e=Tiles.Tile=function(e,i){this.id=e,this.top=0,this.left=0,this.width=0,this.height=0,this.$el=t(i||document.createElement("div"))};e.prototype.appendTo=function(t,e,i,n){this.$el.hide().appendTo(t),e?this.$el.delay(i).fadeIn(n):this.$el.show()},e.prototype.remove=function(e,i){e?this.$el.fadeOut({complete:function(){t(this).remove()}}):this.$el.remove()},e.prototype.resize=function(t,e,i,n,r){var s={},o=!1;this.left!==e.x&&(s.left=e.x,this.left=e.x,o=!0),this.top!==e.y&&(s.top=e.y,this.top=e.y,o=!0),this.width!==e.width&&(s.width=e.width,this.width=e.width,o=!0),this.height!==e.height&&(s.height=e.height,this.height=e.height,o=!0);var l=this,a=function(){var t=l.$el[0];l.left!==t.offsetLeft&&l.$el.css("left",l.left),l.top!==t.offsetTop&&l.$el.css("top",l.top),r&&r()};i&&o?this.$el.animate(s,{duration:n,easing:"swing",complete:a}):(o&&this.$el.css(s),setTimeout(a,n))}}(jQuery),function(t){function e(t,e,i,n){this.x=t,this.y=e,this.width=i,this.height=n}e.prototype.copy=function(){return new e(this.x,this.y,this.width,this.height)},Tiles.Rectangle=e;Tiles.Template=function(t,e,i){this.rects=t,this.numTiles=this.rects.length,this.numRows=i,this.numCols=e},Tiles.Template.prototype.copy=function(){var t,e,i=[];for(e=0,t=this.rects.length;e<t;e++)i.push(this.rects[e].copy());return new Tiles.Template(i,this.numCols,this.numRows)},Tiles.Template.prototype.append=function(t){if(this.numCols!==t.numCols)throw"Appended templates must have the same number of columns";var i,n,r,s=this.numRows;for(i=0,n=t.rects.length;i<n;i++)r=t.rects[i],this.rects.push(new e(r.x,s+r.y,r.width,r.height));this.numRows+=t.numRows,this.numTiles+=t.numTiles},Tiles.Template.fromJSON=function(t){var i=function(t){var e,i,n,r,s,o=[],l=t.length;for(i=0;i<l;i++)for(n=t[i],o[i]=[],e=0,r=n.length;e<r;e++)" "!==(s=n[e])&&o[i].push(s);return o}(t),n=function(t){var i,n,r,s,o,l,a,h=[],d=t.length,c=0===d?0:t[0].length;for(t=t.slice(),o=0;o<d;o++)t[o]=t[o].slice();for(o=0;o<d;o++)for(s=0;s<c;s++)if(null!=(i=t[o][s])){if(r=1,n=1,i!==Tiles.Template.SINGLE_CELL){for(;r+s<c&&i===t[o][s+r];)r++;for(;n+o<d&&i===t[o+n][s];)n++}for(a=0;a<n;a++)for(l=0;l<r;l++)t[o+a][s+l]=null;h.push(new e(s,o,r,n))}return h}(i);return new Tiles.Template(n,i.length>0?i[0].length:0,i.length)},Tiles.Template.prototype.toJSON=function(){var t,e,i,n,r,s,o="ABCDEFGHIJKLMNOPQRSTUVWXYZ",l=o.length,a=0,h=[];for(r=0;r<this.numRows;r++)for(h[r]=[],n=0;n<this.numCols;n++)h[r][n]=Tiles.Template.SINGLE_CELL;for(t=0,e=this.rects.length;t<e;t++)if((i=this.rects[t]).width>1||i.height>1){for(s=o[a],r=0;r<i.height;r++)for(n=0;n<i.width;n++)h[i.y+r][i.x+n]=s;a=(a+1)%l}for(r=0;r<this.numRows;r++)h[r]=h[r].join("");return h},Tiles.Template.SINGLE_CELL="."}(jQuery),Tiles.UniformTemplates={get:function(t,e){var i,n,r=Math.ceil(e/t),s=[];for(n=0;n<r;n++)for(i=0;i<t;i++)s.push(new Tiles.Rectangle(i,n,1,1));return new Tiles.Template(s,t,r)}},function(t){var e=Tiles.Grid=function(e){this.$el=t(e),this.animationDuration=500,this.cellSizeMin=150,this.templateFactory=Tiles.UniformTemplates,this.priorityPageSize=Number.MAX_VALUE,this.cellPadding=10,this.cellSize=0,this.numCols=1,this.template=null,this.isDirty=!0,this.tiles=[],this.tilesAdded=[],this.tilesRemoved=[]};function i(t,e,i){var n=t.y+t.height,r=t.x+t.width;return!(!e||e.top>n||e.top+e.height<t.y||e.left>r||e.left+e.width<t.x)||!(!i||i.y>n||i.y+i.height<t.y||i.x>r||i.x+i.width<t.x)}e.prototype.getContentWidth=function(){return this.$el.width()},e.prototype.resizeColumns=function(){var t=this.getContentWidth();return Math.max(1,Math.floor((t+this.cellPadding)/(this.cellSizeMin+this.cellPadding)))},e.prototype.resizeCellSize=function(){var t=this.getContentWidth();return Math.ceil((t+this.cellPadding)/this.numCols)-this.cellPadding},e.prototype.resize=function(){var t=this.resizeColumns();this.numCols!==t&&t>0&&(this.numCols=t,this.isDirty=!0);var e=this.resizeCellSize();this.cellSize!==e&&e>0&&(this.cellSize=e,this.isDirty=!0)},e.prototype.updateTiles=function(e){var i,n,r,s,o=(e=function(e){var i,n,r=[],s=e?e.length:0;for(i=0;i<s;i++)n=e[i],-1===t.inArray(n,r)&&r.push(n);return r}(e)).length,l=[];for(i=this.tiles.length-1;i>=0;i--)n=this.tiles[i],(s=t.inArray(n.id,e))<0?this.tilesRemoved.push(n):l[s]=n;for(this.tiles=[],i=0;i<o;i++){if(!(n=l[i])){if(r=e[i],this.createTile){if(!(n=this.createTile(r)))continue}else n=new Tiles.Tile(r);this.tilesAdded.push(n)}this.tiles.push(n)}},e.prototype.insertTiles=function(t){this.addTiles(t,!0)},e.prototype.addTiles=function(t,e){if(t&&0!==t.length){var i,n=[],r=this.tiles.length;for(i=0;i<r;i++)n.push(this.tiles[i].id);var s=e?t.concat(n):n.concat(t);this.updateTiles(s)}},e.prototype.removeTiles=function(e){if(e&&0!==e.length){var i,n,r,s=[];for(i=0,n=this.tiles.length;i<n;i++)r=this.tiles[i].id,-1===t.inArray(r,e)&&s.push(r);this.updateTiles(s)}},e.prototype.createTemplate=function(t,e){t=Math.max(1,t);var i=this.templateFactory.get(t,e);return i||(i=Tiles.UniformTemplates.get(t,e)),i},e.prototype.ensureTemplate=function(t){if(this.template&&this.template.numCols===this.numCols){var e=t-this.template.rects.length;e>0&&(this.template.append(this.createTemplate(this.numCols,e)),this.isDirty=!0)}else this.template=this.createTemplate(this.numCols,t),this.isDirty=!0},e.prototype.shouldRedraw=function(){return this.cellSize<=0&&this.resize(),this.ensureTemplate(this.tiles.length),this.isDirty||this.tilesAdded.length>0||this.tilesRemoved.length>0},e.prototype.redraw=function(e,n){if(this.shouldRedraw()){var r,s,o,l,a,h,d,c,u,p,f,g=this.tiles.length,m=this.priorityPageSize,w=this.animationDuration,y=this.cellSize+this.cellPadding,v=0,T=0,b=new Tiles.Rectangle(this.$el.scrollLeft(),this.$el.scrollTop(),this.$el.width(),this.$el.height());for(v=0;v<g;v+=m)for(o=this.template.rects.slice(v,v+m),l=this.tiles.slice(v,v+m),p=o.slice(0),f=l.slice(0),this.prioritizePage&&this.prioritizePage(p,f),a=0,h=f.length;a<h;a++)r=f[a],s=t.inArray(r,this.tilesAdded)>=0,d=p[a],c=new Tiles.Rectangle(d.x*y,d.y*y,d.width*y-this.cellPadding,d.height*y-this.cellPadding),r.resize(d,c,e&&!s&&i(b,r,c),w),s&&(T=(u=e&&i(b,null,c))&&this.getAppendDelay?this.getAppendDelay(d,o,p,r,l,f):0,r.appendTo(this.$el,u,T,w));for(a=0,h=this.tilesRemoved.length;a<h;a++)r=this.tilesRemoved[a],u=e&&i(b,r,null),r.remove(u,w);this.tilesRemoved=[],this.tilesAdded=[],this.isDirty=!1,n&&setTimeout(function(){n(!0)},w+10)}else n&&n(!1)}}(jQuery),function(t,e){if(!t.fn.dotdotdot){t.fn.dotdotdot=function(e){if(0==this.length)return t.fn.dotdotdot.debug('No element found for "'+this.selector+'".'),this;if(this.length>1)return this.each(function(){t(this).dotdotdot(e)});var n=this;n.data("dotdotdot")&&n.trigger("destroy.dot"),n.data("dotdotdot-style",n.attr("style")||""),n.css("word-wrap","break-word"),"nowrap"===n.css("white-space")&&n.css("white-space","normal"),n.bind_events=function(){return n.bind("update.dot",function(e,i){e.preventDefault(),e.stopPropagation(),d.maxHeight="number"==typeof d.height?d.height:function(t){for(var e=t.innerHeight(),i=["paddingTop","paddingBottom"],n=0,r=i.length;n<r;n++){var s=parseInt(t.css(i[n]),10);isNaN(s)&&(s=0),e-=s}return e}(n),d.maxHeight+=d.tolerance,void 0!==i&&(("string"==typeof i||i instanceof HTMLElement)&&(i=t("<div />").append(i).contents()),i instanceof t&&(r=i)),(g=n.wrapInner('<div class="dotdotdot" />').children()).contents().detach().end().append(r.clone(!0)).find("br").replaceWith("  <br />  ").end().css({height:"auto",width:"auto",border:"none",padding:0,margin:0});var l=!1,p=!1;return u.afterElement&&((l=u.afterElement.clone(!0)).show(),u.afterElement.detach()),s(g,d)&&(p="children"==d.wrap?function(t,e,i){var n=t.children(),r=!1;t.empty();for(var o=0,l=n.length;o<l;o++){var a=n.eq(o);if(t.append(a),i&&t.append(i),s(t,e)){a.remove(),r=!0;break}i&&i.detach()}return r}(g,d,l):function e(i,n,r,l,d){var u=!1;i.contents().detach().each(function(){var p=this,f=t(p);if(void 0===p||3==p.nodeType&&0==t.trim(p.data).length)return!0;if(f.is("script"))i.append(f);else{if(u)return!0;i.append(f),d&&i[i.is("table, thead, tbody, tfoot, tr, col, colgroup, object, embed, param, ol, ul, dl, blockquote, select, optgroup, option, textarea, script, style")?"after":"append"](d),s(r,l)&&((u=3==p.nodeType?function(e,i,n,r,l){var d=e[0];if(!d)return!1;var u=h(d),p=-1!==u.indexOf(" ")?" ":"ã€€",f="letter"==r.wrap?"":p,g=u.split(f),m=-1,w=-1,y=0,v=g.length-1;r.fallbackToLetter&&0==y&&0==v&&(f="",g=u.split(f),v=g.length-1);for(;y<=v&&(0!=y||0!=v);){var T=Math.floor((y+v)/2);if(T==w)break;w=T,a(d,g.slice(0,w+1).join(f)+r.ellipsis),s(n,r)?(v=w,r.fallbackToLetter&&0==y&&0==v&&(f="",g=g[0].split(f),m=-1,w=-1,y=0,v=g.length-1)):(m=w,y=w)}if(-1==m||1==g.length&&0==g[0].length){var b=e.parent();e.detach();var x=l&&l.closest(b).length?l.length:0;b.contents().length>x?d=c(b.contents().eq(-1-x),i):(d=c(b,i,!0),x||b.detach()),d&&(u=o(h(d),r),a(d,u),x&&l&&t(d).parent().append(l))}else u=o(g.slice(0,m+1).join(f),r),a(d,u);return!0}(f,n,r,l,d):e(f,n,r,l,d))||(f.detach(),u=!0)),u||d&&d.detach()}});return u}(g,n,g,d,l)),g.replaceWith(g.contents()),g=null,t.isFunction(d.callback)&&d.callback.call(n[0],p,r),u.isTruncated=p,p}).bind("isTruncated.dot",function(t,e){return t.preventDefault(),t.stopPropagation(),"function"==typeof e&&e.call(n[0],u.isTruncated),u.isTruncated}).bind("originalContent.dot",function(t,e){return t.preventDefault(),t.stopPropagation(),"function"==typeof e&&e.call(n[0],r),r}).bind("destroy.dot",function(t){t.preventDefault(),t.stopPropagation(),n.unwatch().unbind_events().contents().detach().end().append(r).attr("style",n.data("dotdotdot-style")||"").data("dotdotdot",!1)}),n},n.unbind_events=function(){return n.unbind(".dot"),n},n.watch=function(){if(n.unwatch(),"window"==d.watch){var e=t(window),i=e.width(),r=e.height();e.bind("resize.dot"+u.dotId,function(){i==e.width()&&r==e.height()&&d.windowResizeFix||(i=e.width(),r=e.height(),f&&clearInterval(f),f=setTimeout(function(){n.trigger("update.dot")},100))})}else p=l(n),f=setInterval(function(){if(n.is(":visible")){var t=l(n);p.width==t.width&&p.height==t.height||(n.trigger("update.dot"),p=t)}},500);return n},n.unwatch=function(){return t(window).unbind("resize.dot"+u.dotId),f&&clearInterval(f),n};var r=n.contents(),d=t.extend(!0,{},t.fn.dotdotdot.defaults,e),u={},p={},f=null,g=null;return d.lastCharacter.remove instanceof Array||(d.lastCharacter.remove=t.fn.dotdotdot.defaultArrays.lastCharacter.remove),d.lastCharacter.noEllipsis instanceof Array||(d.lastCharacter.noEllipsis=t.fn.dotdotdot.defaultArrays.lastCharacter.noEllipsis),u.afterElement=function(e,i){if(!e)return!1;if("string"==typeof e)return!!(e=t(e,i)).length&&e;return!!e.jquery&&e}(d.after,n),u.isTruncated=!1,u.dotId=i++,n.data("dotdotdot",!0).bind_events().trigger("update.dot"),d.watch&&n.watch(),n},t.fn.dotdotdot.defaults={ellipsis:"... ",wrap:"word",fallbackToLetter:!0,lastCharacter:{},tolerance:0,callback:null,after:null,height:null,watch:!1,windowResizeFix:!0},t.fn.dotdotdot.defaultArrays={lastCharacter:{remove:[" ","ã€€",",",";",".","!","?"],noEllipsis:[]}},t.fn.dotdotdot.debug=function(t){};var i=1,n=t.fn.html;t.fn.html=function(e){return void 0!=e&&!t.isFunction(e)&&this.data("dotdotdot")?this.trigger("update",[e]):n.apply(this,arguments)};var r=t.fn.text;t.fn.text=function(e){return void 0!=e&&!t.isFunction(e)&&this.data("dotdotdot")?(e=t("<div />").text(e).html(),this.trigger("update",[e])):r.apply(this,arguments)}}function s(t,e){return t.innerHeight()>e.maxHeight}function o(e,i){for(;t.inArray(e.slice(-1),i.lastCharacter.remove)>-1;)e=e.slice(0,-1);return t.inArray(e.slice(-1),i.lastCharacter.noEllipsis)<0&&(e+=i.ellipsis),e}function l(t){return{width:t.innerWidth(),height:t.innerHeight()}}function a(t,e){t.innerText?t.innerText=e:t.nodeValue?t.nodeValue=e:t.textContent&&(t.textContent=e)}function h(t){return t.innerText?t.innerText:t.nodeValue?t.nodeValue:t.textContent?t.textContent:""}function d(t){do{t=t.previousSibling}while(t&&1!==t.nodeType&&3!==t.nodeType);return t}function c(e,i,n){var r,s=e&&e[0];if(s){if(!n){if(3===s.nodeType)return s;if(t.trim(e.text()))return c(e.contents().last(),i)}for(r=d(s);!r;){if((e=e.parent()).is(i)||!e.length)return!1;r=d(e[0])}if(r)return c(t(r),i)}return!1}}(jQuery),function(t){t.wptiles={debounce:function(t,e,i){var n;return function(){var r=this,s=arguments;i&&!n&&t.apply(r,s),clearTimeout(n),n=setTimeout(function(){n=null,i||t.apply(r,s)},e)}},resizeParent:function(e,i){var n=e.children(".wp-tiles-tile"),r=parseInt(e.offset().top),s=0;n.each(function(){var e=t(this),i=e.height()+e.offset().top;i>s&&(s=i)}),parseInt(i)}},t.fn.extend({wptiles:function(e){var i,n=t(this),r=t("#"+e.id+"-templates"),s=t("#"+e.id+"-pagination"),o=!1,l=!1,a=function(){var i,s;return o||(t.each(e.grids,function(){return s=this,!1}),o=s),e.breakpoint?(i=n.width()<e.breakpoint)&&!l?(r.hide(),l=!0,e.small_screen_grid):!i&&l?(r.show(),l=!1,o):i?e.small_screen_grid:o:o},h=function(){t.wptiles.resizeParent(n,e.padding),t(".wp-tiles-byline").dotdotdot(),n.trigger("wp-tiles:resize")};n.addClass("wp-tiles-loaded"),e.breakpoint&&(e.small_screen_grid=Tiles.Template.fromJSON(e.small_screen_grid));var d={};t.each(e.grids,function(t){d[t]=Tiles.Template.fromJSON(this)}),e.grids=d,i=t.extend(new Tiles.Grid(n),{cellPadding:parseInt(e.padding),template:a(),templateFactory:{get:function(t,e){for(var i=a().copy(),n=e-i.rects.length;n>0;){var r,s=[],o=a().copy();if(n<=o.rects.length)s=o.rects,n=0;else{for(r=0;r<o.rects.length;r++)s.push(o.rects[r].copy());n-=o.rects.length}i.append(new Tiles.Template(s,o.numCols,o.numRows))}return i}},resizeColumns:function(){return this.template.numCols},createTile:function(i){var n=new Tiles.Tile(i.id,i),r=n.$el,s=parseInt(i.id.match(/[0-9]{1,}/)),o=e.colors[s%e.colors.length];if(r.css("background-color",o),t(".wp-tiles-tile-with-image",r).get(0)){if("random"===e.byline_color){var l=t(".wp-tiles-byline",r),a=e.byline_opacity,h=o,d="rgba"===h.substr(0,4)?h:h.replace("rgb","rgba").replace(")",","+a+")"),c=d.lastIndexOf(","),u=d.slice(0,c+1)+a+")";l.css("background-color",u)}var p=t(".wp-tiles-tile-bg .wp-tiles-img",r),f=p[0].src;t(".wp-tiles-tile-bg",r).css({"background-image":"url('"+f+"')","-ms-filter":"progid:DXImageTransform.Microsoft.AlphaImageLoader( src='"+f+"', sizingMethod='scale')",filter:"progid:DXImageTransform.Microsoft.AlphaImageLoader( src='"+f+"', sizingMethod='scale')"}),p.first().remove()}return n},nextPage:function(){e.next_query&&(void 0!==i.nextPage.running&&i.nextPage.running||(i.nextPage.running=!0,s.addClass("loading"),e.next_query.opts||(e.next_query.opts={},t.each(["hide_title","link","byline_template","byline_template_textonly","images_only","image_size","text_only","link_new_window"],function(){e.next_query.opts[this]=e[this]})),t.post(e.ajaxurl,e.next_query).success(function(n){"-1"==n&&s.fadeOut(function(){s.removeClass("loading")}),n.has_more?(e.next_query.query.paged++,e.next_query._ajax_nonce=n._ajax_nonce,s.removeClass("loading")):(e.next_query=!1,s.fadeOut(function(){s.removeClass("loading")})),t(".wp-tiles-container #wp_tiles_1").append(n.tiles),i.nextPage.running=!1})))}});var c=t(".wp-tiles-tile",n);if(i.updateTiles(c),i.redraw(e.animate_init,h),function(){var i=function(t,e){t.css("color",e),t.find(":header").css("color",e)},r=t(".wp-tiles-tile-with-image .wp-tiles-byline",n);if(r.get(0)&&("random"!==e.byline_color&&r.css("background-color",e.byline_color),r.css(e.byline_height_auto?"max-height":"height",e.byline_height+"%"),e.image_text_color&&i(r,e.image_text_color)),e.text_color){var s=t(".wp-tiles-tile-text-only .wp-tiles-byline",n);s.get(0)&&i(s,e.text_color)}}(),t(window).resize(t.wptiles.debounce(function(){i.template=a(),i.isDirty=!0,i.resize(),i.redraw(e.animate_resize,h)},200)),r.get(0)){var u=t(".wp-tiles-template",r);u.css("background-color",e.grid_selector_color),u.on("click",function(n){n.preventDefault(),u.removeClass("selected"),t(this).addClass("selected");var r,s=e.grids[t(this).data("grid")];o=r=s,i.template=r,i.isDirty=!0,i.resize(),i.redraw(e.animate_template,h)})}s.get(0)&&s.hasClass("wp-tiles-pagination-ajax")&&s.click(function(t){t.preventDefault(),i.nextPage()}),e.grid=i}}),"object"==typeof wptilesdata&&t(function(){t.each(wptilesdata,function(){t("#"+this.id).wptiles(this)}),t(window).trigger("resize")})}(jQuery);